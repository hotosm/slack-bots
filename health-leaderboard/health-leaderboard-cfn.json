{
  "AWSTemplateFormatVersion": "2010-09-09",
  "Description": "Lambda-SNS pair for health-leaderboard Slack command",
  "Resources": {
    "HealthLeaderboardLambda": {
      "Type": "AWS::Lambda::Function",
      "Properties": {
        "FunctionName": "health-leaderboard",
        "Handler": "index.handler",
        "Role": "arn:aws:iam::670261699094:role/service-role/test-slack-router-role-4hs4dpro",
        "Code": {
          "S3Bucket": "lambda-andria",
          "S3Key": "health-leaderboard.zip"
        },
        "Runtime": "nodejs12.x",
        "Timeout": "30"
      }
    },
    "HealthLeaderboardSNS": {
      "Type": "AWS::SNS::Topic",
      "Properties": {
        "TopicName": "health-leaderboard",
        "Subscription": [{
          "Endpoint": {
            "Fn::GetAtt": [
              "HealthLeaderboardLambda",
              "Arn"
            ]
          },
          "Protocol": "lambda"
        }]
      }
    },
    "HealthLeaderboardPermission": {
      "Type" : "AWS::Lambda::Permission",
      "Properties" : {
        "Action" : "lambda:InvokeFunction",
        "FunctionName" : { "Ref": "HealthLeaderboardLambda" },
        "Principal" : "sns.amazonaws.com",
        "SourceArn" : { "Ref": "HealthLeaderboardSNS" }
      }
    }
  }
}